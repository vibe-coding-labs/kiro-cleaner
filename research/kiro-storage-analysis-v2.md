# Kiro å­˜å‚¨ç»“æ„åˆ†ææŠ¥å‘Š v2

## å®é™…å­˜å‚¨ç»“æ„ï¼ˆ2026å¹´1æœˆ5æ—¥æ›´æ–°ï¼‰

åŸºäºå¯¹ `~/Library/Application Support/kiro/` çš„å®é™…åˆ†æã€‚

## 1. ç›®å½•ç»“æ„æ¦‚è§ˆ

### 1.1 ä¸»è¦ç›®å½•åŠå¤§å°
| ç›®å½• | å¤§å° | è¯´æ˜ |
|------|------|------|
| User/ | ~122MB | ç”¨æˆ·æ•°æ®ï¼ˆæœ€é‡è¦ï¼‰ |
| WebStorage/ | ~75MB | Webå­˜å‚¨æ•°æ® |
| Local Storage/ | ~62MB | æœ¬åœ°å­˜å‚¨ |
| CachedData/ | ~31MB | ç¼“å­˜æ•°æ® |
| Crashpad/ | ~22MB | å´©æºƒæŠ¥å‘Š |
| logs/ | ~6MB | æ—¥å¿—æ–‡ä»¶ |
| Cache/ | ~5MB | ç¼“å­˜ |
| GPUCache/ | ~2.4MB | GPUç¼“å­˜ |

### 1.2 User ç›®å½•è¯¦ç»†ç»“æ„
```
User/
â”œâ”€â”€ globalStorage/           # 32MB - å…¨å±€å­˜å‚¨
â”‚   â”œâ”€â”€ kiro.kiroagent/     # Kiro Agent æ ¸å¿ƒæ•°æ®
â”‚   â”‚   â”œâ”€â”€ <workspace_hash>/  # å·¥ä½œåŒºæ•°æ®
â”‚   â”‚   â”‚   â”œâ”€â”€ *.chat         # å¯¹è¯æ–‡ä»¶ï¼ˆJSONï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ f62de366...    # æ‰§è¡ŒçŠ¶æ€æ–‡ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ <hash>/        # ä»£ç å¿«ç…§ç›®å½•
â”‚   â”‚   â”œâ”€â”€ workspace-sessions/  # ä¼šè¯ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ <base64_path>/   # base64ç¼–ç çš„è·¯å¾„
â”‚   â”‚   â”‚       â”œâ”€â”€ sessions.json
â”‚   â”‚   â”‚       â””â”€â”€ <uuid>.json
â”‚   â”‚   â”œâ”€â”€ index/             # ç´¢å¼•æ•°æ®åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ index.sqlite   # ä¸»ç´¢å¼•ï¼ˆ~12MBï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ docs.sqlite
â”‚   â”‚   â”‚   â”œâ”€â”€ autocompleteCache.sqlite
â”‚   â”‚   â”‚   â””â”€â”€ lancedb/       # å‘é‡æ•°æ®åº“
â”‚   â”‚   â”œâ”€â”€ dev_data/          # å¼€å‘æ•°æ®
â”‚   â”‚   â”œâ”€â”€ config.json        # é…ç½®
â”‚   â”‚   â””â”€â”€ .migrations/       # è¿ç§»è®°å½•
â”‚   â””â”€â”€ state.vscdb            # VS Code çŠ¶æ€æ•°æ®åº“
â”œâ”€â”€ History/                 # 90MB - æ–‡ä»¶ç¼–è¾‘å†å²
â”‚   â””â”€â”€ <hash>/              # æ¯ä¸ªæ–‡ä»¶çš„å†å²
â”‚       â”œâ”€â”€ entries.json     # å†å²æ¡ç›®
â”‚       â””â”€â”€ <id>.<ext>       # å†å²ç‰ˆæœ¬æ–‡ä»¶
â”œâ”€â”€ workspaceStorage/        # 112KB - å·¥ä½œåŒºå­˜å‚¨
â”‚   â””â”€â”€ <hash>/
â”‚       â”œâ”€â”€ state.vscdb
â”‚       â””â”€â”€ workspace.json
â”œâ”€â”€ settings.json            # ç”¨æˆ·è®¾ç½®
â””â”€â”€ mcp.json                 # MCP é…ç½®
```

## 2. å…³é”®æ•°æ®ç±»å‹

### 2.1 å¯¹è¯æ•°æ® (.chat æ–‡ä»¶)
- ä½ç½®: `User/globalStorage/kiro.kiroagent/<workspace_hash>/*.chat`
- æ ¼å¼: JSON
- ç»“æ„:
```json
{
  "chat": [
    {"role": "human", "content": "..."},
    {"role": "bot", "content": "..."},
    {"role": "tool", "content": "..."}
  ],
  "metadata": {
    "modelId": "...",
    "modelProvider": "...",
    "workflow": "...",
    "startTime": 1767547292184,
    "endTime": 1767547300000
  }
}
```

### 2.2 ä¼šè¯æ•°æ® (workspace-sessions)
- ä½ç½®: `User/globalStorage/kiro.kiroagent/workspace-sessions/<base64_path>/`
- sessions.json: ä¼šè¯åˆ—è¡¨
- <uuid>.json: å®Œæ•´ä¼šè¯å†å²ï¼ˆåŒ…å« promptLogsï¼‰

### 2.3 æ‰§è¡ŒçŠ¶æ€æ–‡ä»¶
- æ–‡ä»¶å: `f62de366d0006e17ea00a01f6624aabf`ï¼ˆå›ºå®šåç§°ï¼‰
- å†…å®¹: å½“å‰æ‰§è¡ŒçŠ¶æ€
```json
{
  "executions": [
    {
      "executionId": "...",
      "type": "chat-agent",
      "status": "running",
      "startTime": 1767547292184
    }
  ],
  "version": "2.0.0"
}
```

### 2.4 ç´¢å¼•æ•°æ®åº“
- index.sqlite: ä»£ç ç´¢å¼•ï¼ˆæœ€å¤§ï¼Œ~12MBï¼‰
- docs.sqlite: æ–‡æ¡£ç´¢å¼•
- autocompleteCache.sqlite: è‡ªåŠ¨è¡¥å…¨ç¼“å­˜
- lancedb/: å‘é‡æ•°æ®åº“ï¼ˆç”¨äºè¯­ä¹‰æœç´¢ï¼‰

### 2.5 æ–‡ä»¶ç¼–è¾‘å†å² (History)
- æ¯ä¸ªç¼–è¾‘è¿‡çš„æ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªå“ˆå¸Œç›®å½•
- entries.json è®°å½•å†å²ç‰ˆæœ¬
- å®é™…æ–‡ä»¶å†…å®¹ä¿å­˜ä¸º <id>.<ext>

## 3. å·²ä¿®å¤çš„ä»£ç é—®é¢˜

### 3.1 è·¯å¾„å¤§å°å†™é—®é¢˜ âœ… å·²ä¿®å¤
- é—®é¢˜: ä»£ç ä½¿ç”¨å¤§å†™ "Kiro"ï¼Œå®é™…è·¯å¾„æ˜¯å°å†™ "kiro"
- ä¿®å¤: åŒæ—¶æ£€æŸ¥å¤§å°å†™ä¸¤ç§è·¯å¾„

### 3.2 ç‰¹æ®Šç›®å½•æ’é™¤ âœ… å·²ä¿®å¤
- é—®é¢˜: æ‰«ææ—¶æ²¡æœ‰æ’é™¤ç‰¹æ®Šç›®å½•ï¼ˆindex, dev_data, workspace-sessionsç­‰ï¼‰
- ä¿®å¤: æ·»åŠ  specialDirs æ˜ å°„ï¼Œåœ¨æ‰«ææ—¶è·³è¿‡è¿™äº›ç›®å½•

### 3.3 æ–‡ä»¶ç±»å‹æ£€æµ‹ âœ… å·²ä¿®å¤
- é—®é¢˜: .chat å’Œ .vscdb æ–‡ä»¶è¢«è¯†åˆ«ä¸º TypeUnknown
- ä¿®å¤: æ·»åŠ å¯¹è¿™äº›æ–‡ä»¶ç±»å‹çš„è¯†åˆ«

### 3.4 å®‰å…¨æ£€æŸ¥å¢å¼º âœ… å·²ä¿®å¤
- é—®é¢˜: æ¸…ç†é€»è¾‘å¯èƒ½è¯¯åˆ é‡è¦æ–‡ä»¶
- ä¿®å¤: æ·»åŠ  protectedFiles å’Œ protectedDirs ä¿æŠ¤åˆ—è¡¨

## 4. å®‰å…¨æ¸…ç†è§„åˆ™

### 4.1 å¯å®‰å…¨æ¸…ç†
| ç±»å‹ | æ¡ä»¶ | é£é™©çº§åˆ« |
|------|------|----------|
| ä¸´æ—¶æ–‡ä»¶ | ä»»ä½•æ—¶å€™ | ä½ |
| æ—¥å¿—æ–‡ä»¶ | è¶…è¿‡7å¤© | ä½ |
| ç¼“å­˜æ–‡ä»¶ | ä»»ä½•æ—¶å€™ | ä½ |
| å´©æºƒæŠ¥å‘Š | è¶…è¿‡30å¤© | ä½ |
| æ–‡ä»¶å†å² | è¶…è¿‡30å¤© | ä¸­ |
| æ—§å¯¹è¯ | è¶…è¿‡30å¤©ï¼ˆéœ€ç¡®è®¤ï¼‰ | ä¸­ |

### 4.2 å—ä¿æŠ¤æ–‡ä»¶ï¼ˆä¸åº”åˆ é™¤ï¼‰
- config.json
- settings.json
- mcp.json
- sessions.json
- state.vscdb
- workspace.json
- storage.json

### 4.3 å—ä¿æŠ¤ç›®å½•ï¼ˆä¸åº”åˆ é™¤å…¶ä¸­æ–‡ä»¶ï¼‰
- index/ - ä»£ç ç´¢å¼•
- .migrations/ - è¿ç§»è®°å½•
- lancedb/ - å‘é‡æ•°æ®åº“

## 5. ç»Ÿè®¡ç»“æœç¤ºä¾‹

è¿è¡Œ `./kiro-cleaner status --detailed` çš„è¾“å‡ºï¼š
```
ğŸ“Š Kiroæ•°æ®çŠ¶æ€æŠ¥å‘Š
==================================================
æ€»å­˜å‚¨ä½¿ç”¨: 604.23 MB
ç¼“å­˜å¤§å°: 235.22 MB
æ—¥å¿—å¤§å°: 31.85 MB
ä¸´æ—¶æ–‡ä»¶: 43.14 MB

ğŸ’¬ å¯¹è¯æ•°æ®ç»Ÿè®¡
æ€»å¯¹è¯æ•°: 80
æ€»æ¶ˆæ¯æ•°: 2942
  - ç”¨æˆ·æ¶ˆæ¯: 226
  - åŠ©æ‰‹æ¶ˆæ¯: 1463
  - å·¥å…·æ¶ˆæ¯: 1253
å¹³å‡æ¯å¯¹è¯æ¶ˆæ¯æ•°: 36.8
å¯¹è¯æ•°æ®å¤§å°: 2.29 MB

ğŸ“ å·¥ä½œåŒºåˆ†è§£
  031d794b...: 37å¯¹è¯, 1554æ¶ˆæ¯, 1.04 MB
  1207ab7a...: 33å¯¹è¯, 1238æ¶ˆæ¯, 999.69 KB
  ff3831e0...: 10å¯¹è¯, 150æ¶ˆæ¯, 276.77 KB

ğŸ” å¯æ¸…ç†å¯¹è¯
30å¤©å‰çš„æ—§å¯¹è¯: 0ä¸ª (0 B)
å¤§å¯¹è¯(>1MB): 0ä¸ª (0 B)
å¯æ¸…ç†ä¸´æ—¶/æ—¥å¿—æ–‡ä»¶: 76ä¸ª (43.14 MB)

ğŸ’¾ æ€»è®¡å¯é‡Šæ”¾ç©ºé—´: 43.14 MB
```

## 6. åç»­æ”¹è¿›å»ºè®®

1. **æ·»åŠ  workspace-sessions ç»Ÿè®¡**: ç»Ÿè®¡ä¼šè¯æ•°æ®çš„å¤§å°
2. **æ·»åŠ  History æ¸…ç†**: æ¸…ç†è¶…è¿‡30å¤©çš„æ–‡ä»¶ç¼–è¾‘å†å²
3. **æ·»åŠ  Crashpad æ¸…ç†**: æ¸…ç†å´©æºƒæŠ¥å‘Š
4. **æ·»åŠ äº¤äº’å¼æ¸…ç†**: è®©ç”¨æˆ·é€‰æ‹©è¦æ¸…ç†çš„é¡¹ç›®
5. **æ·»åŠ å®šæ—¶æ¸…ç†**: æ”¯æŒå®šæ—¶è‡ªåŠ¨æ¸…ç†
